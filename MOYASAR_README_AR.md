# ุฅุถุงูุฉ ุจูุงุจุฉ ุงูุฏูุน Moyasar

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ ุจูุงุจุฉ ุงูุฏูุน **Moyasar** ุจูุฌุงุญ ุฅูู ุญุฒูุฉ Nafezly Payments. Moyasar ูู ุจูุงุจุฉ ุฏูุน ุณุนูุฏูุฉ ุชุฏุนู:

- **ุงูุฏูุน ุจุงูุจุทุงูุงุช ุงูุงุฆุชูุงููุฉ** (Visa, Mastercard, Mada)
- **Apple Pay**
- **STC Pay**

## ุงููููุงุช ุงููุถุงูุฉ

### 1. ูุฆุฉ ุงูุฏูุน ุงูุฑุฆูุณูุฉ
๐ `src/Classes/MoyasarPayment.php`

ุชุญุชูู ุนูู:
- ูุธููุฉ `pay()` ูุฅูุดุงุก ุทูุจ ุงูุฏูุน
- ูุธููุฉ `verify()` ููุชุญูู ูู ุงูุฏูุน
- ุฏุนู ุทุฑู ุงูุฏูุน ุงููุชุนุฏุฏุฉ
- ุชุญููู ุชููุงุฆู ูููุจุงูุบ ุฅูู ุฃุตุบุฑ ูุญุฏุฉ ุนููุฉ

### 2. ูุงุฌูุฉ HTML
๐ `resources/views/html/moyasar.blade.php`

ุตูุญุฉ ุฏูุน ูุงููุฉ ุชุญุชูู ุนูู:
- ุชุตููู ุนุตุฑู ููุชุฌุงูุจ
- ุชุญููู ููุชุจุฉ Moyasar JavaScript
- ูููุฐุฌ ุงูุฏูุน ุงูุชูุงุนูู
- ูุนุงูุฌุฉ ุงูุฃุญุฏุงุซ (ุงููุฌุงุญุ ุงููุดู)
- ุนุฑุถ ุงููุจูุบ ูุงูุนููุฉ

### 3. ููู ุงูุฅุนุฏุงุฏุงุช
๐ `config/nafezly-payments.php`

ุชู ุฅุถุงูุฉ:
```php
#MOYASAR
'MOYASAR_SECRET_KEY'=>env('MOYASAR_SECRET_KEY'),
'MOYASAR_PUBLISHABLE_KEY'=>env('MOYASAR_PUBLISHABLE_KEY'),
'MOYASAR_CURRENCY'=>env('MOYASAR_CURRENCY','SAR'),
```

### 4. Service Provider
๐ `src/NafezlyPaymentsServiceProvider.php`

ุชู ุฅุถุงูุฉ:
- ุงุณุชูุฑุงุฏ ูุฆุฉ MoyasarPayment
- ุชุณุฌูู ุงููุฆุฉ ูู ุญุงููุฉ Laravel

### 5. ุงูุชูุซูู ูุงูุฃูุซูุฉ
๐ `examples/MOYASAR_INTEGRATION.md` - ุฏููู ุงูุชูุงูู ุงูุดุงูู ุจุงูุฅูุฌููุฒูุฉ
๐ `examples/moyasar_example.php` - ุฃูุซูุฉ ุนูููุฉ ููุงุณุชุฎุฏุงู

## ุฎุทูุงุช ุงูุชูุนูู

### 1. ุฅุถุงูุฉ ููุงุชูุญ API ุฅูู ููู .env

```env
# Moyasar Payment Gateway
MOYASAR_SECRET_KEY=sk_test_xxxxxxxxxxxxxxxxxxxxxxxxxx
MOYASAR_PUBLISHABLE_KEY=pk_test_xxxxxxxxxxxxxxxxxxxxxxxxxx
MOYASAR_CURRENCY=SAR
```

**ููุงุญุธุฉ ูููุฉ:** Moyasar ูุณุชุฎุฏู ููุนูู ูู ุงูููุงุชูุญ ููุท:
- **Secret Key** (`sk_test_xxx` ุฃู `sk_live_xxx`): ููุณุชุฎุฏู ูุฌููุน ุนูููุงุช Backend API (ุงูุชุญููุ ุงูุงุณุชุนูุงูุ ุฅูุฎ)
- **Publishable Key** (`pk_test_xxx` ุฃู `pk_live_xxx`): ููุณุชุฎุฏู ููุท ูู ูููุฐุฌ ุงูุฏูุน ุจุงูู Frontend
- **ูุง ุชุดุงุฑู Secret Key ุฃุจุฏูุง ูู ููุฏ Frontend!**

### 2. ุงูุญุตูู ุนูู ููุงุชูุญ API

1. ุณุฌู ูู [ููุญุฉ ุชุญูู Moyasar](https://dashboard.moyasar.com/register/new)
2. ุงูุชูู ุฅูู ุงูุฅุนุฏุงุฏุงุช > API Keys
3. ุณุชุฌุฏ ููุชุงุญูู:
   - **Secret Key**: ููุงุณุชุฎุฏุงู ูู Backend (ูุจุฏุฃ ุจู `sk_test_` ุฃู `sk_live_`)
   - **Publishable Key**: ููุงุณุชุฎุฏุงู ูู Frontend (ูุจุฏุฃ ุจู `pk_test_` ุฃู `pk_live_`)
4. ููุงุฎุชุจุงุฑุ ุงุณุชุฎุฏู ููุงุชูุญ Test
5. ููุฅูุชุงุฌุ ุงุณุชุฎุฏู ููุงุชูุญ Live

### 3. ุฅุนุฏุงุฏ ุงููุณุงุฑุงุช

```php
// routes/web.php
Route::get('/payment/verify/{payment}', [PaymentController::class, 'verify'])
    ->name('verify-payment');
```

## ุงูุงุณุชุฎุฏุงู ุงูุฃุณุงุณู

### ุฅูุดุงุก ุนูููุฉ ุฏูุน

```php
use Nafezly\Payments\Classes\MoyasarPayment;

$payment = new MoyasarPayment();

$result = $payment
    ->setAmount(100)                    // ุงููุจูุบ ุจุงูุฑูุงู ุงูุณุนูุฏู
    ->setUserFirstName('ุฃุญูุฏ')          // ุงูุงุณู ุงูุฃูู
    ->setUserLastName('ูุญูุฏ')            // ุงูุงุณู ุงูุฃุฎูุฑ
    ->setUserEmail('ahmed@example.com') // ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
    ->setUserPhone('966501234567')      // ุฑูู ุงูุฌูุงู
    ->pay();

// ุนุฑุถ ูููุฐุฌ ุงูุฏูุน
return view('payment', ['html' => $result['html']]);
```

### ุงูุชุญูู ูู ุงูุฏูุน

```php
public function verify(Request $request)
{
    $payment = new MoyasarPayment();
    $result = $payment->verify($request);
    
    if ($result['success']) {
        // ูุฌุญุช ุงูุนูููุฉ
        $paymentId = $result['payment_id'];
        $data = $result['process_data'];
        
        // ุงุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุชุ ุฃุฑุณู ุจุฑูุฏ ุชุฃููุฏุ ุฅูุฎ.
        
        return redirect('/success');
    } else {
        // ูุดูุช ุงูุนูููุฉ
        return redirect('/failed');
    }
}
```

## ุทุฑู ุงูุฏูุน ุงููุฎุชููุฉ

### 1. ุงูุจุทุงูุงุช ุงูุงุฆุชูุงููุฉ ููุท
```php
$result = $payment
    ->setAmount(100)
    ->setSource('creditcard')
    ->pay();
```

### 2. STC Pay ููุท
```php
$result = $payment
    ->setAmount(100)
    ->setSource('stcpay')
    ->pay();
```

### 3. Apple Pay ููุท
```php
$result = $payment
    ->setAmount(100)
    ->setSource('applepay')
    ->pay();
```

### 4. ุฌููุน ุงูุทุฑู (ุงูุชุฑุงุถู)
```php
$result = $payment
    ->setAmount(100)
    ->pay(); // ูุง ุชุญุฏุฏ source
```

## ูููู ุงูุงุณุชุฌุงุจุฉ

### ุงุณุชุฌุงุจุฉ ูุงุฌุญุฉ
```php
[
    'success' => true,
    'payment_id' => 'abc123...',
    'message' => 'ุชูุช ุงูุนูููุฉ ุจูุฌุงุญ',
    'process_data' => [
        'id' => 'abc123...',
        'status' => 'paid',
        'amount' => 10000, // ุจุงููููุฉ (100 ุฑูุงู)
        'currency' => 'SAR',
        // ... ุจูุงูุงุช ุฃุฎุฑู
    ]
]
```

### ุงุณุชุฌุงุจุฉ ูุงุดูุฉ
```php
[
    'success' => false,
    'payment_id' => 'abc123...',
    'message' => 'ูุดูุช ุงูุนูููุฉ',
    'process_data' => [/* ุชูุงุตูู ุงูุฎุทุฃ */]
]
```

## ุชุญููู ุงูุนููุงุช

ูุชู ุชุญููู ุงููุจูุบ ุชููุงุฆููุง ุฅูู ุฃุตุบุฑ ูุญุฏุฉ ุนููุฉ:

- **SAR**: 1 ุฑูุงู = 100 ูููุฉ
- **KWD**: 1 ุฏููุงุฑ = 1000 ููุณ
- **USD**: 1 ุฏููุงุฑ = 100 ุณูุช

ูุซุงู:
```php
->setAmount(100)  // 100 ุฑูุงู
// ูุชู ุชุญูููู ุชููุงุฆููุง ุฅูู 10000 ูููุฉ ูู API
```

## ุงูุงุฎุชุจุงุฑ

### ุจุทุงูุงุช ุงูุงุฎุชุจุงุฑ

**ุฏูุน ูุงุฌุญ:**
- ุฑูู ุงูุจุทุงูุฉ: `4111 1111 1111 1111`
- CVV: ุฃู 3 ุฃุฑูุงู
- ุชุงุฑูุฎ ุงูุงูุชูุงุก: ุฃู ุชุงุฑูุฎ ูุณุชูุจูู

**ุฏูุน ูุงุดู:**
- ุฑูู ุงูุจุทุงูุฉ: `4000 0000 0000 0002`

**ูุชุทูุจ 3D Secure:**
- ุฑูู ุงูุจุทุงูุฉ: `4000 0000 0000 3063`

### ุงุฎุชุจุงุฑ STC Pay
- ุฑูู ุงูุฌูุงู: `0500000001`
- ุฑูุฒ OTP: `1234`

## ุงูููุฒุงุช ุงูุฅุถุงููุฉ

### 1. ูุนุฑู ุฏูุน ูุฎุตุต
```php
$payment
    ->setPaymentId('ORDER-2024-00123')
    ->setAmount(100)
    ->pay();
```

### 2. ุฅุถุงูุฉ ูุนูููุงุช ุงููุณุชุฎุฏู
```php
$payment
    ->setUserId(123)
    ->setUserFirstName('ุฃุญูุฏ')
    ->setUserLastName('ุงูุณุนูุฏ')
    ->setUserEmail('ahmed@example.com')
    ->setUserPhone('966501234567')
    ->pay();
```

### 3. ุนููุงุช ูุฎุชููุฉ
```php
$payment
    ->setAmount(50)
    ->setCurrency('USD')
    ->pay();
```

## ููุงุญุธุงุช ุงูุฃูุงู

1. โ **ูุง ุชุดุงุฑู ููุชุงุญ API ุงูุณุฑู ุฃุจุฏูุง**
2. โ **ุชุญูู ุฏุงุฆููุง ูู ุงูุฏูุน ุนูู ุงูุณูุฑูุฑ**
3. โ **ุงุณุชุฎุฏู HTTPS ูู ุงูุฅูุชุงุฌ**
4. โ **ุชุญูู ูู ุตุญุฉ callback URL**
5. โ **ุณุฌู ุฌููุน ุงููุนุงููุงุช**

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูููุฐุฌ ุงูุฏูุน ูุง ูุธูุฑ
- ุชุญูู ูู ุตุญุฉ ููุชุงุญ Publishable Key
- ุชุฃูุฏ ูู ุชุญููู ูููุงุช Moyasar CSS ู JS
- ุงูุญุต console ุงููุชุตูุญ

### ูุดู ุงูุชุญูู ูู ุงูุฏูุน
- ุชุญูู ูู ุตูุงุญูุงุช ููุชุงุญ API
- ุชุฃูุฏ ูู ุชูุฑูุฑ payment ID ุจุดูู ุตุญูุญ
- ุชุญูู ูู ูุฏุฑุฉ ุงูุณูุฑูุฑ ุนูู ุฅุฑุณุงู ุทูุจุงุช HTTPS

### ุนุฏู ุชุทุงุจู ุงููุจูุบ
- ุงููุจุงูุบ ุชูุญูู ุชููุงุฆููุง ูุฃุตุบุฑ ูุญุฏุฉ
- ุชุญูู ุฏุงุฆููุง ูู ุงููุจูุบ ุจุนุฏ ุงูุฏูุน

## ุงูุฏุนู ุงูููู

**Moyasar:**
- ุงููููุน: [https://moyasar.com](https://moyasar.com)
- ุงูุฏุนู: [care@moyasar.com](mailto:care@moyasar.com)
- ูุงุชู: 800 1111 848
- ุงูุชูุซูู: [https://docs.moyasar.com](https://docs.moyasar.com)

## ุงูุฎูุงุตุฉ

ุชู ุชูุงูู Moyasar ุจูุฌุงุญ ูุน ุญุฒูุฉ Nafezly Payments ุจุงุณุชุฎุฏุงู:

โ Form Integration (ูููุณ API ุงููุจุงุดุฑ)  
โ ุฏุนู ุฌููุน ุทุฑู ุงูุฏูุน (ุจุทุงูุงุชุ Apple Payุ STC Pay)  
โ ูุงุฌูุฉ HTML ูุงููุฉ ูุน ุชุตููู ูุชุฌุงูุจ  
โ ูุนุงูุฌุฉ ุชููุงุฆูุฉ ูููุจุงูุบ ูุงูุนููุงุช  
โ ุชูุซูู ุดุงูู ูุฃูุซูุฉ ุนูููุฉ  
โ ูุชูุงูู ูุน ุจููุฉ ุงูุจูุฌ ุงูุญุงููุฉ  

**ุงูุชูุงูู ุฌุงูุฒ ููุงุณุชุฎุฏุงู! ๐**
